<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet id="2025-05-14-02-test-users-data" author="claude">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="USERS"/>
            <tableExists tableName="USER_ROLE"/>
        </preConditions>

        <comment>Добавление тестовых пользователей с фиксированными ID</comment>

        <!-- Вставка пользователей с явными ID -->
        <sql>
            INSERT INTO USERS (ID, EMAIL, PASSWORD, FIRST_NAME, LAST_NAME, DISPLAY_NAME)
            VALUES
                (1, 'user@gmail.com', '{noop}password', 'userFirstName', 'userLastName', 'userDisplayName'),
                (2, 'admin@gmail.com', '{noop}admin', 'adminFirstName', 'adminLastName', 'adminDisplayName'),
                (3, 'guest@gmail.com', '{noop}guest', 'guestFirstName', 'guestLastName', 'guestDisplayName'),
                (4, 'manager@gmail.com', '{noop}manager', 'managerFirstName', 'managerLastName', 'managerDisplayName');
        </sql>

        <!-- Назначение ролей по фиксированным ID -->
        <sql>
            INSERT INTO USER_ROLE (USER_ID, ROLE)
            VALUES
                (1, 0),  -- user@gmail.com = DEV
                (2, 0),  -- admin@gmail.com = DEV
                (2, 1),  -- admin@gmail.com = ADMIN
                (4, 2);  -- manager@gmail.com = MANAGER
        </sql>

        <!-- Обновление последовательности для H2 -->
        <sql dbms="h2">
            ALTER TABLE USERS ALTER COLUMN ID RESTART WITH 5;
        </sql>
    </changeSet>
</databaseChangeLog>